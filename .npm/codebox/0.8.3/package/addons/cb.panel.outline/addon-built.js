define("settings",[],function(){var e=codebox.require("core/settings");return e.add({namespace:"outline",title:"Outline",defaults:{separator:".",startup:!1},fields:{separator:{label:"Tag Parts Separator",type:"text"},startup:{label:"Show Outline Panel at Startup",type:"checkbox"}}})}),define("require-tools/less/normalize",[],function(){function r(e,r,i){if(e.indexOf("data:")===0)return e;e=t(e);var u=i.match(n),a=r.match(n);return a&&(!u||u[1]!=a[1]||u[2]!=a[2])?s(e,r):o(s(e,r),i)}function s(e,t){e.substr(0,2)=="./"&&(e=e.substr(2));if(e.match(/^\//)||e.match(n))return e;var r=t.split("/"),i=e.split("/");r.pop();while(curPart=i.shift())curPart==".."?r.pop():r.push(curPart);return r.join("/")}function o(e,t){var n=t.split("/");n.pop(),t=n.join("/")+"/",i=0;while(t.substr(i,1)==e.substr(i,1))i++;while(t.substr(i,1)!="/")i--;t=t.substr(i+1),e=e.substr(i+1),n=t.split("/");var r=e.split("/");out="";while(n.shift())out+="../";while(curPart=r.shift())out+=curPart+"/";return out.substr(0,out.length-1)}var e=/([^:])\/+/g,t=function(t){return t.replace(e,"$1/")},n=/[^\:\/]*:\/\/([^\/])*/,u=function(e,n,i){n=t(n),i=t(i);var s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\(\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/ig,o,u,e;while(o=s.exec(e)){u=o[3]||o[2]||o[5]||o[6]||o[4];var a;a=r(u,n,i);var f=o[5]||o[6]?1:0;e=e.substr(0,s.lastIndex-u.length-f-1)+a+e.substr(s.lastIndex-f-1),s.lastIndex=s.lastIndex+(a.length-u.length)}return e};return u.convertURIBase=r,u.absoluteURI=s,u.relativeURI=o,u}),define("require-tools/less/less",["require"],function(e){var t={};t.pluginBuilder="./less-builder";if(typeof window=="undefined")return t.load=function(e,t,n){n()},less;t.normalize=function(e,t){return e.substr(e.length-5,5)==".less"&&(e=e.substr(0,e.length-5)),e=t(e),e};var n=document.getElementsByTagName("head")[0],r=window.location.href.split("/");r[r.length-1]="",r=r.join("/");var i;window.less=window.less||{env:"development"};var s=0,o;t.inject=function(e){s<31&&(o=document.createElement("style"),o.type="text/css",n.appendChild(o),s++),o.styleSheet?o.styleSheet.cssText+=e:o.appendChild(document.createTextNode(e))};var u;return t.load=function(n,s,o,a){e(["./lessc","./normalize"],function(a,f){if(!i){var l=e.toUrl("base_url").split("/");l[l.length-1]="",i=f.absoluteURI(l.join("/"),r)+"/"}var c=s.toUrl(n+".less");c=f.absoluteURI(c,i),u=u||new a.Parser(window.less),u.parse('@import "'+c+'";',function(e,n){if(e)return o.error(e);t.inject(f(n.toCSS(),c,r)),setTimeout(o,7)})})},t}),define("require-tools/less/less!stylesheets/panel",[],function(){}),define("views/tags",["settings","less!stylesheets/panel.less"],function(e){var t=codebox.require("hr/utils"),n=codebox.require("hr/promise"),r=codebox.require("hr/dom"),i=codebox.require("hr/hr"),s=codebox.require("utils/contextmenu"),o=codebox.require("core/backends/rpc"),u=codebox.require("core/box"),a=codebox.require("core/files"),f=i.View.extend({className:"outline-file",events:{click:"onClick","keyup input":"onKeyup"},initialize:function(){f.__super__.initialize.apply(this,arguments),this.$filterInput=r("<input>",{type:"text","class":"form-control input-sm",placeholder:"Filter Tags"}),this.$tree=r("<ul>",{"class":"tags-tree"}),this.$filterInput.appendTo(this.$el),this.$tree.appendTo(this.$el)},render:function(){var e=this;return this.updateTags().fail(function(t){e.$tree.html("<div class='alert'>"+(t.message||t)+"</div>")}).fin(function(){e.ready()})},addTag:function(e,t,n){var i,s=this,o=function(){a.open(s.options.path,{pattern:e.pattern.slice(2,-2)})},u=r("<li>",{"data-tag":e.name,"class":"type-"+(e.kind||"v"),click:function(e){e.stopPropagation(),u.toggleClass("open"),n||o()},dblclick:o}),f=r("<span>",{text:e.showName});return f.appendTo(u),n?(i=r("<ul>",{"class":"tags-tree"}).appendTo(u),r("<i>",{"class":"fa fa-angle-right tag-icon-close"}).prependTo(f),r("<i>",{"class":"fa fa-angle-down tag-icon-open"}).prependTo(f)):r("<i>",{"class":"fa fa-blank"}).prependTo(f),u.appendTo(t),{$tag:u,$children:i}},getTag:function(e){var t=this.$("li[data-tag='"+e+"']");return t.length==0?null:r(t.get(0))},convertTagsToTree:function(n){var r=this,i={},s=e.user.get("separator");return t.chain(n).sortBy(function(e){return e.name.length}).each(function(e){var n=i,r=e.name.split(s),o=t.last(r);t.each(r,function(e,t){if(!n[e])return o=r.slice(t,r.length).join(s),!1;n=n[e].children}),n[o]=e,n[o].showName=o,n[o].children={}}),i},updateTags:function(){var e="No outline available for the current file.",r=this,i,s=this.options.path;return this.$tree.empty(),!s||s=="/"?n.reject(e):o.execute("codecomplete/get",{file:s}).then(function(s){if(s.results.length==0)return n.reject(e);i=r.convertTagsToTree(s.results);var o=function(e,n){t.each(n,function(n,i){var s=r.addTag(n,e,t.size(n.children)>0);o(s.$children,n.children)})};o(r.$tree,i)})},onClick:function(){this.$filterInput.focus()},onKeyup:function(e){var t=this.$filterInput.val().toLowerCase();this.$("li").each(function(){r(this).toggle(!t||r(this).text().toLowerCase().indexOf(t)!==-1)})}});return f}),define("views/panel",["settings","views/tags"],function(e,t){var n=codebox.require("views/panels/file"),r=n.extend({className:"cb-panel-outline",FileView:t});return r}),define("client",["settings","views/panel"],function(e,t){var n=codebox.require("core/commands/toolbar"),r=codebox.require("core/app"),i=codebox.require("core/panels"),s=codebox.require("core/commands/menu"),o=codebox.require("core/box"),u=i.register("outline",t,{title:"Outline"});u.connectCommand(n.register("outline.open",{category:"Panels",title:"Outline",description:"Open Outline Panel",icons:{"default":"code"},position:2,shortcuts:[]})),e.user.get("startup")&&u.open()}),function(e){var t=document,n="appendChild",r="styleSheet",i=t.createElement("style");i.type="text/css",t.getElementsByTagName("head")[0][n](i),i[r]?i[r].cssText=e:i[n](t.createTextNode(e))}('.cb-panel-outline{position:absolute;top:0;bottom:0;left:0;width:100%;z-index:10}.cb-panel-outline .tags-tree{margin:0;padding:0;list-style:none}.cb-panel-outline .tags-tree li span{display:block;padding:2px 8px;cursor:default;position:relative;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.cb-panel-outline .tags-tree li span:hover{background:rgba(0,0,0,.05)}.cb-panel-outline .tags-tree li span:before{content:" ";background:#b55761;width:8px;height:8px;position:absolute;border-radius:16px;top:8px;left:19px;border:1px solid #000}.cb-panel-outline .tags-tree li.type-v span:before{background:#81a2be}.cb-panel-outline .tags-tree li.type-f span:before{background:#9dbe8c}.cb-panel-outline .tags-tree li i{width:24px}.cb-panel-outline .tags-tree li .tags-tree{padding-left:15px;display:none}.cb-panel-outline .tags-tree li .tag-icon-close{display:inline-block}.cb-panel-outline .tags-tree li .tag-icon-open{display:none}.cb-panel-outline .tags-tree li.open>.tag-icon-open{display:inline-block}.cb-panel-outline .tags-tree li.open>.tag-icon-close{display:none}.cb-panel-outline .tags-tree li.open>.tags-tree{display:block}.cb-panel-outline .outline-file>.tags-tree{position:absolute;top:0;bottom:40px;left:5px;right:5px;z-index:10;overflow-y:auto}.cb-panel-outline .outline-file>.tags-tree .alert{text-align:center}.cb-panel-outline .outline-file input,.cb-panel-outline .outline-file input:focus{position:absolute;bottom:6px;left:4px;right:4px;width:calc(100% - 8px);box-shadow:none}');